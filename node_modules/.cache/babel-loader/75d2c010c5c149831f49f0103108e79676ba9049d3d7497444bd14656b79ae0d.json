{"ast":null,"code":"import { supabase } from '../lib/supabase';\nexport const orderService = {\n  // Criar um novo pedido\n  async createOrder(orderData) {\n    try {\n      // Primeiro, inserir o pedido principal\n      const {\n        data: order,\n        error: orderError\n      } = await supabase.from('orders').insert([{\n        customer_name: orderData.customer.name,\n        customer_phone: orderData.customer.phone,\n        customer_address: JSON.stringify(orderData.customer.address),\n        customer_notes: orderData.customer.notes,\n        total_value: orderData.total,\n        status: 'pending',\n        created_at: orderData.createdAt\n      }]).select().single();\n      if (orderError) {\n        throw orderError;\n      }\n\n      // Depois, inserir os itens do pedido\n      const orderItems = orderData.items.map(item => ({\n        order_id: order.id,\n        material_name: item.name,\n        category: item.category,\n        quantity: item.quantity,\n        unit: item.unit,\n        measure_type: item.measureType,\n        vehicle: item.vehicle,\n        unit_price: item.unitPrice,\n        total_price: item.totalPrice\n      }));\n      const {\n        error: itemsError\n      } = await supabase.from('order_items').insert(orderItems);\n      if (itemsError) {\n        throw itemsError;\n      }\n      return {\n        success: true,\n        order\n      };\n    } catch (error) {\n      console.error('Erro ao criar pedido:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  },\n  // Buscar todos os pedidos\n  async getOrders() {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('orders').select(`\n          *,\n          order_items (*)\n        `).order('created_at', {\n        ascending: false\n      });\n      if (error) {\n        throw error;\n      }\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Erro ao buscar pedidos:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  },\n  // Atualizar status do pedido\n  async updateOrderStatus(orderId, status) {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('orders').update({\n        status\n      }).eq('id', orderId).select().single();\n      if (error) {\n        throw error;\n      }\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Erro ao atualizar status:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  },\n  // Buscar pedido por ID\n  async getOrderById(orderId) {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('orders').select(`\n          *,\n          order_items (*)\n        `).eq('id', orderId).single();\n      if (error) {\n        throw error;\n      }\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Erro ao buscar pedido:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n};","map":{"version":3,"names":["supabase","orderService","createOrder","orderData","data","order","error","orderError","from","insert","customer_name","customer","name","customer_phone","phone","customer_address","JSON","stringify","address","customer_notes","notes","total_value","total","status","created_at","createdAt","select","single","orderItems","items","map","item","order_id","id","material_name","category","quantity","unit","measure_type","measureType","vehicle","unit_price","unitPrice","total_price","totalPrice","itemsError","success","console","message","getOrders","ascending","updateOrderStatus","orderId","update","eq","getOrderById"],"sources":["C:/Users/Administrator/Downloads/estudos/estudos/Gh/src/services/orderService.js"],"sourcesContent":["import { supabase } from '../lib/supabase'\r\n\r\nexport const orderService = {\r\n  // Criar um novo pedido\r\n  async createOrder(orderData) {\r\n    try {\r\n      // Primeiro, inserir o pedido principal\r\n      const { data: order, error: orderError } = await supabase\r\n        .from('orders')\r\n        .insert([\r\n          {\r\n            customer_name: orderData.customer.name,\r\n            customer_phone: orderData.customer.phone,\r\n            customer_address: JSON.stringify(orderData.customer.address),\r\n            customer_notes: orderData.customer.notes,\r\n            total_value: orderData.total,\r\n            status: 'pending',\r\n            created_at: orderData.createdAt\r\n          }\r\n        ])\r\n        .select()\r\n        .single()\r\n\r\n      if (orderError) {\r\n        throw orderError\r\n      }\r\n\r\n      // Depois, inserir os itens do pedido\r\n      const orderItems = orderData.items.map(item => ({\r\n        order_id: order.id,\r\n        material_name: item.name,\r\n        category: item.category,\r\n        quantity: item.quantity,\r\n        unit: item.unit,\r\n        measure_type: item.measureType,\r\n        vehicle: item.vehicle,\r\n        unit_price: item.unitPrice,\r\n        total_price: item.totalPrice\r\n      }))\r\n\r\n      const { error: itemsError } = await supabase\r\n        .from('order_items')\r\n        .insert(orderItems)\r\n\r\n      if (itemsError) {\r\n        throw itemsError\r\n      }\r\n\r\n      return { success: true, order }\r\n    } catch (error) {\r\n      console.error('Erro ao criar pedido:', error)\r\n      return { success: false, error: error.message }\r\n    }\r\n  },\r\n\r\n  // Buscar todos os pedidos\r\n  async getOrders() {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('orders')\r\n        .select(`\r\n          *,\r\n          order_items (*)\r\n        `)\r\n        .order('created_at', { ascending: false })\r\n\r\n      if (error) {\r\n        throw error\r\n      }\r\n\r\n      return { success: true, data }\r\n    } catch (error) {\r\n      console.error('Erro ao buscar pedidos:', error)\r\n      return { success: false, error: error.message }\r\n    }\r\n  },\r\n\r\n  // Atualizar status do pedido\r\n  async updateOrderStatus(orderId, status) {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('orders')\r\n        .update({ status })\r\n        .eq('id', orderId)\r\n        .select()\r\n        .single()\r\n\r\n      if (error) {\r\n        throw error\r\n      }\r\n\r\n      return { success: true, data }\r\n    } catch (error) {\r\n      console.error('Erro ao atualizar status:', error)\r\n      return { success: false, error: error.message }\r\n    }\r\n  },\r\n\r\n  // Buscar pedido por ID\r\n  async getOrderById(orderId) {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('orders')\r\n        .select(`\r\n          *,\r\n          order_items (*)\r\n        `)\r\n        .eq('id', orderId)\r\n        .single()\r\n\r\n      if (error) {\r\n        throw error\r\n      }\r\n\r\n      return { success: true, data }\r\n    } catch (error) {\r\n      console.error('Erro ao buscar pedido:', error)\r\n      return { success: false, error: error.message }\r\n    }\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}